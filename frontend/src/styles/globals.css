@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --header-height: 64px;
  --minimap-height: 120px;
  --sidebar-left-width: 280px;
  --sidebar-left-collapsed: 60px;
  --sidebar-right-width: 320px;
  --sidebar-right-collapsed: 48px;
  --footer-nav-height: 72px;

  /* Primary */
  --primary-main: #5325BA;
  --primary-light: #875FED;
  --primary-dark: #3D1A8C;
  
  /* Neutral */
  --neutral-light: #E0E0E0;
  --neutral-dark: #121011;
  --neutral-white: #FFFFFF;
  
  /* Gradient */
  --gradient-main: linear-gradient(180deg, #FFFFFF 0%, #D8B0FF 70%, #6A5EFF 100%);
  --gradient-card: linear-gradient(135deg, #FFFFFF 0%, #F5EEFF 100%);

  /* Secondary */
  --secondary-purple-1: #875FED;
  --secondary-purple-2: #6A5EFF;
  --secondary-blue: #A1BDF8;
  --secondary-lavender: #A48CED;
  --secondary-pink: #D8B0FF;
  --secondary-green: #A2EDB4;

  /* Semantic */
  --success: #A2EDB4;
  --warning: #FFD166;
  --error: #EF476F;
  --info: #A1BDF8;
  
  /* Text */
  --text-primary: #121011;
  --text-secondary: #5A5A5A;
  --text-disabled: #9E9E9E;
  --text-inverse: #FFFFFF;
  
  /* Background */
  --bg-primary: #FFFFFF;
  --bg-secondary: #F8F6FF;
  --bg-tertiary: #F0EBFF;
}

body {
  margin: 0;
  font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Passage content styles */
.passage-content {
  @apply text-gray-700 leading-relaxed;
}

.passage-content h1 {
  @apply text-3xl font-bold text-gray-900 mb-4;
}

.passage-content h2 {
  @apply text-2xl font-semibold text-gray-800 mb-3;
}

.passage-content h3 {
  @apply text-xl font-semibold text-gray-800 mb-2;
}

.passage-content p {
  @apply text-gray-700 leading-relaxed mb-4;
}

.passage-content ul, .passage-content ol {
  @apply mb-4 pl-6;
}

.passage-content li {
  @apply mb-2;
}

.passage-content a {
  @apply text-primary-600 hover:text-primary-700 underline;
}

.passage-content code {
  @apply bg-gray-100 px-1.5 py-0.5 rounded text-sm font-mono;
}

.passage-content pre {
  @apply bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto mb-4;
}

.passage-content pre code {
  @apply bg-transparent p-0;
}

.passage-content img {
  @apply rounded-lg max-w-full h-auto;
}

.passage-content blockquote {
  @apply border-l-4 border-primary-500 pl-4 italic text-gray-600;
}

.passage-content table {
  @apply w-full border-collapse mb-4;
}

.passage-content th, .passage-content td {
  @apply border border-gray-300 px-4 py-2 text-left;
}

.passage-content th {
  @apply bg-gray-100 font-semibold;
}

/* React Flow custom styles */
.react-flow__node-passage {
  @apply bg-white border-2 border-gray-200 rounded-lg shadow-sm;
}

.react-flow__node-passage.selected {
  @apply border-primary-500;
}

.react-flow__edge-path {
  @apply stroke-gray-400 stroke-2;
}

.react-flow__edge.selected .react-flow__edge-path {
  @apply stroke-primary-500;
}

/* CodeMirror Twine Syntax Highlighting */
.passage-code-editor .cm-editor {
  min-height: 200px;
  font-size: 14px;
}

.passage-code-editor .cm-editor.cm-focused {
  outline: 2px solid #6366f1;
  outline-offset: -2px;
}

.passage-code-editor .cm-passage-link {
  color: #2563eb;
  text-decoration: underline;
  cursor: pointer;
}

.passage-code-editor .cm-macro {
  color: #7c3aed;
  font-weight: 500;
}

.passage-code-editor .cm-variable {
  color: #059669;
  font-weight: 500;
}

.passage-code-editor .cm-hook {
  color: #d97706;
  font-style: italic;
}

.passage-code-editor .cm-string {
  color: #0891b2;
}

.passage-code-editor .cm-comment {
  color: #6b7280;
  font-style: italic;
}

/* Twine-style passage content rendering */
.twine-content .passage-link {
  @apply text-primary-600 hover:text-primary-700 underline cursor-pointer;
}

.twine-content .macro-if {
  @apply block;
}

.twine-content .variable-display {
  @apply font-semibold text-green-600;
}

.twine-content .hook-hidden {
  @apply hidden;
}

.twine-content .hook-visible {
  @apply block;
}

/* Broken passage link styles */
.passage-link-broken {
  color: #dc2626; /* red-600 */
  text-decoration: underline wavy;
  cursor: not-allowed;
}

.passage-link-broken:hover {
  background-color: #fee2e2; /* red-100 */
}

/* TipTap Editor Enhanced Styles */
.ProseMirror mark {
  border-radius: 0.25rem;
  padding: 0.125rem 0.25rem;
  margin: 0 0.125rem;
}

.ProseMirror a {
  color: var(--primary-main);
  text-decoration: underline;
  cursor: pointer;
  transition: color 0.15s ease;
}

.ProseMirror a:hover {
  color: var(--primary-dark);
}

/* React Flow Enhanced Styles */
.react-flow__node {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.react-flow__node:hover {
  z-index: 100 !important;
}

.react-flow__node.selected {
  z-index: 101 !important;
}

.react-flow__edge {
  transition: stroke 0.2s ease;
}

.react-flow__edge:hover .react-flow__edge-path {
  stroke-width: 3px;
}

.react-flow__controls {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

.react-flow__controls-button {
  transition: background-color 0.15s ease;
}

.react-flow__controls-button:hover {
  background-color: #f3f4f6 !important;
}

.react-flow__minimap {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

/* Form Input Focus States */
input:focus,
select:focus,
textarea:focus {
  outline: none;
}

/* Button Loading Animation */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* Tooltip Arrow */
.tooltip-arrow {
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border-width: 4px;
  border-style: solid;
  border-color: #1f2937 transparent transparent transparent;
}

/* Save Status Transitions */
.save-status-enter {
  opacity: 0;
  transform: translateY(-4px);
}

.save-status-enter-active {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.save-status-exit {
  opacity: 1;
}

.save-status-exit-active {
  opacity: 0;
  transition: opacity 0.2s ease;
}

/* Drag & Drop Overlay */
.drag-overlay {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
  border: 2px dashed var(--primary-main);
  backdrop-filter: blur(4px);
}
